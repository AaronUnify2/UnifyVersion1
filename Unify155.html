<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unify</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    margin: 20px;
    background-color: #121212; /* Dark background */
    color: #ffffff; /* Light text color for readability */
}

.section {
    border: 1px solid #333; /* Darker border color */
    padding: 7px;
    margin: 10px 0;
    background-color: #1e1e1e; /* Slightly lighter dark background */
}

.section-title {
    display: flex;
    justify-content: space-between;
    cursor: pointer;
    padding: 10px;
    background-color: #2a2a2a; /* Dark background for section titles */
    border-bottom: 1px solid #333;
    font-weight: bold;
    color: #ffffff;
}

.section-content {
    display: none;
    padding: 7px;
    background-color: #123524; /* Match section background */
}

.section-content.active {
    display: block;
}

.form-container, .section-content {
    border: 1px solid #333;
    padding: 7px;
    background-color: #2a2a2a; /* Dark form background */
    color: #ffffff;
}

.form-container label, .section-content label {
    display: block;
    margin-bottom: 10px;
}

.form-container input[type="text"], .form-container select, .section-content input[type="text"], .section-content select {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    box-sizing: border-box;
    background-color: #333; /* Dark input background */
    color: #ffffff; /* Light text color */
    border: 1px solid #444; /* Darker border */
}

.form-container input[type="radio"], .list-container input[type="radio"] {
    margin-right: 5px;
}

.form-container button, .section-content button {
    margin-top: 10px;
    padding: 10px;
    color: white;
    border: none;
    cursor: pointer;
}

button.add-button, button.delete-button {
    background-color: #4CAF50;
    margin: 10px auto;
    padding: 10px;
    color: white;
    border: none;
    cursor: pointer;
    display: block;
    width: auto;
    text-align: center;
    font-size: 14px;
}

button.delete-button {
    background-color: #e24136;
}

.list-item {
    border: 1px solid #333;
    padding: 15px;
    margin: 10px 0;
    background-color: #2a2a2a;
    color: #ffffff;
}

.list-item-title {
    display: flex;
    justify-content: space-between;
    cursor: pointer;
    font-weight: bold;
}

.list-item-content {
    display: none;
    margin-top: 10px;
}

.list-item-content.active {
    display: block;
}

ul {
    padding: 0;
    margin: 0;
    list-style-type: none;
}

.large-input {
    height: 10em;
    resize: vertical;
    box-sizing: border-box;
    width: 100%;
    padding: 8px;
    background-color: #333;
    color: #ffffff;
    border: 1px solid #444;
}

.description {
    margin-top: 10px;
    color: #aaa; /* Lighter gray for descriptions */
}

.sort-buttons {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
}

.sort-buttons button {
    padding: 5px 10px;
    cursor: pointer;
    background-color: #444;
    color: #ffffff;
}

.sort-buttons button.active {
    background-color: #555;
    color: white;
}

textarea {
    width: 100%;
    height: 10em;
    resize: vertical;
    box-sizing: border-box;
    padding: 8px;
    background-color: #333;
    color: #ffffff;
    border: 1px solid #444;
}

button.add-Calendar {
    background-color: #4CAF50;
    margin: 10px auto;
}

.help-button {
    background-color: #007BFF;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    margin-left: 10px;
}

.help-content {
    display: none;
    margin-top: 10px;
    background-color: #1e1e1e;
    padding: 10px;
    border: 1px solid #333;
}

.help-content.active {
    display: block;
}

    </style>
</head>
<body>
    <h1 style="text-align: center;">Unify <button class="help-button" onclick="toggleHelp()">?</button></h1>
    <div class="help-content" id="helpContent">
        <h2 style="text-align: center;">Unify: Your Path to Targeted Self-Improvement</h2>
        <p>How Unify Works:</p>
        <ul>
            <li><strong>1. Input Problems:</strong> Identify and rate problems causing negative emotions in different life areas.</li>
            <li><strong>2. Problems List: </strong>Set achievable goals to address your problems. </li>
            <li><strong>3. Goals List: </strong>Identify tasks to accomplish your goals </li>
            <li><strong>4. Tasks List:</strong> Achieve your goals by accomplishing tasks, including optional Google Calendar integration.</li>
        </ul>
        <br><hr>
        <p>Using Unify, you'll create a structured approach to problem-solving that enhances your life where it's needed most.</p>
    </div>
    <!-- SECTION 1: Input Problems -->
    <div class="section" id="section1">
        <div class="section-title">
            <span>1. Input Problems</span>
            <span>&#9654;</span>
        </div>
        <div class="section-content">
            <div class="form-container">
                <form id="problemForm">
                    <label>Problem: <input type="text" id="problemInput" size="60"></label>
                    <label>Area:
                        <select id="problemArea">
                            <option>Diet</option>
                            <option>Family</option>
                            <option>Fitness</option>
                            <option>Health</option>
                            <option>Home</option>
                            <option>Parenting</option>
                            <option>Personal</option>
                            <option>Relationship</option>
                            <option>Sleep</option>
                            <option>Social Life</option>
                            <option>Study</option>
                            <option>Work</option>
                        </select>
                    </label>
                    <label>Emotion:
                        <select id="problemEmotion">
                            <option>Annoyed</option>
                            <option>Anxious</option>
                            <option>Bored</option>
                            <option>Depressed</option>
                            <option>Distracted</option>
                            <option>Disapproving</option>
                            <option>Disassociated</option>
                            <option>Embarrassed</option>
                            <option>Envy</option>
                            <option>Guilty</option>
                            <option>Impatient</option>
                            <option>Insecure</option>
                            <option>Let Down</option>
                            <option>Lonely</option>
                            <option>Offended</option>
                            <option>Physical Pain</option>
                            <option>Stressed</option>
                            <option>Tired</option>
                            <option>Vulnerable</option>
                        </select>
                    </label>
                    <label>Difficulty:
                        <input type="radio" name="difficulty" value="1"> 1
                        <input type="radio" name="difficulty" value="2"> 2
                        <input type="radio" name="difficulty" value="3"> 3
                        <input type="radio" name="difficulty" value="4"> 4
                        <input type="radio" name="difficulty" value="5"> 5
                    </label>
                    <div id="problemDescription" class="description"></div>
                    <button type="button" class="add-button" onclick="addProblem()">Add</button>
                </form>
            </div>
        </div>
    </div>

    <!-- SECTION 2: Problems List -->
    <div class="section" id="section2">
        <div class="section-title">
            <span>2. Problems List</span>
            <span>&#9654;</span>
        </div>
        <div class="section-content">
            <div class="sort-buttons">
                <button onclick="sortProblems('recent')">Recent</button>
                <button onclick="sortProblems('area')">Area</button>
                <button onclick="sortProblems('emotion')">Emotion</button>
                <button onclick="sortProblems('difficulty')">Difficulty</button>
            </div>
            <ul id="problemsList">
                <li>Use the form in section 1 to add problems to list</li>
            </ul>
        </div>
    </div>

    <!-- SECTION 3: Goals List -->
    <div class="section" id="section3">
        <div class="section-title">
            <span>3. Goals List</span>
            <span>&#9654;</span>
        </div>
        <div class="section-content">
            <div class="sort-buttons">
                <button onclick="sortGoals('recent')">Recent</button>
                <button onclick="sortGoals('area')">Area</button>
                <button onclick="sortGoals('emotion')">Emotion</button>
                <button onclick="sortGoals('difficulty')">Difficulty</button>
            </div>
            <ul id="goalsList">
                <li>Use section 2 to add goals to list</li>
            </ul>
        </div>
    </div>

    <!-- SECTION 4: Tasks List -->
    <div class="section" id="section4">
        <div class="section-title">
            <span>4. Tasks List</span>
            <span>&#9654;</span>
        </div>
        <div class="section-content">
            <ul id="tasksList">
                <li>Use section 3 to add tasks to list</li>
            </ul>
        </div>
    </div>

    <script>
        function toggleHelp() {
            const helpContent = document.getElementById('helpContent');
            helpContent.classList.toggle('active');
        }

        document.querySelectorAll('.section-title').forEach(title => {
            title.addEventListener('click', () => {
                const content = title.nextElementSibling;
                const arrow = title.querySelector('span:last-child');
                content.classList.toggle('active');
                arrow.innerHTML = content.classList.contains('active') ? '&#9650;' : '&#9654;';
            });
        });

        const problemDescriptions = {
            1: "Fixable now",
            2: "Fixable soon",
            3: "Fixable with the right resources",
            4: "Fixable with the right resources and skills",
            5: "Fixable with the right resources, skills, and cooperation from other people"
        };

        const goalDescriptions = {
            1: "Achievable now",
            2: "Achievable soon",
            3: "Achievable with the right resources",
            4: "Achievable with the right resources and skills",
            5: "Achievable with the right resources, skills, and cooperation from other people"
        };

        document.querySelectorAll('input[name="difficulty"]').forEach(radio => {
            radio.addEventListener('change', (event) => {
                const value = event.target.value;
                const description = problemDescriptions[value];
                document.getElementById('problemDescription').innerText = description;
            });
        });

        function addProblem() {
            const problemInput = document.getElementById('problemInput').value;
            const problemArea = document.getElementById('problemArea').value;
            const problemEmotion = document.getElementById('problemEmotion').value;
            const problemDifficulty = document.querySelector('input[name="difficulty"]:checked').value;
            const problem = { problemInput, problemArea, problemEmotion, problemDifficulty };
            let problems = JSON.parse(localStorage.getItem('problems')) || [];
            problems.push(problem);
            localStorage.setItem('problems', JSON.stringify(problems));
            alert('Problem added to list.');
            renderProblemsList();
        }

        function renderProblemsList() {
            const problems = JSON.parse(localStorage.getItem('problems')) || [];
            const problemsList = document.getElementById('problemsList');
            problemsList.innerHTML = '';
            if (problems.length === 0) {
                problemsList.innerHTML = '<li>Use the form in section 1 to add problems to list</li>';
            } else {
                problems.forEach((problem, index) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-item';
                    listItem.innerHTML = `
                        <div class="list-item-title">
                            <span>${problem.problemInput}</span>

                            <span>&#9654;</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <div>
                                <br>
                                Area: ${problem.problemArea}<br>
                                Emotion: ${problem.problemEmotion}<br> 
                                Difficulty: ${problem.problemDifficulty}<br>
                            </div>
                        </div>
                        <hr>
                        <div class="list-item-content">
                            <label>Goal: <input type="text" id="goalInput${index}"></label>
                            <label>Area:
                                <select id="goalArea${index}">
                                    <option>Diet</option>
                                    <option>Family</option>
                                    <option>Fitness</option>
                                    <option>Health</option>
                                    <option>Home</option>
                                    <option>Parenting</option>
                                    <option>Personal</option>
                                    <option>Relationship</option>
                                    <option>Sleep</option>
                                    <option>Social Life</option>
                                    <option>Study</option>
                                    <option>Work</option>
                                </select>
                            </label>
                            <label>Emotion:
                                <select id="goalEmotion${index}">
                                    <option>Meaningful</option>
                                    <option>Neutral</option>
                                    <option>Difficult</option>
                                </select>
                            </label>
                            <label>Difficulty:
                                <input type="radio" name="goalDifficulty${index}" value="1"> 1
                                <input type="radio" name="goalDifficulty${index}" value="2"> 2
                                <input type="radio" name="goalDifficulty${index}" value="3"> 3
                                <input type="radio" name="goalDifficulty${index}" value="4"> 4
                                <input type="radio" name="goalDifficulty${index}" value="5"> 5
                            </label>
                            <div id="goalDescription${index}" class="description"></div>
                            <button type="button" class="add-button" onclick="addGoal(${index})">Add</button>
<hr>
<button class="delete-button" type="button" onclick="deleteProblem(${index})"><strong>Delete</strong></button>

                        </div>
                    `;
                    listItem.querySelector('.list-item-title').addEventListener('click', () => {
                        const content = listItem.querySelector('.list-item-content');
                        const arrow = listItem.querySelector('.list-item-title span:last-child');
                        content.classList.toggle('active');
                        arrow.innerHTML = content.classList.contains('active') ? '&#9650;' : '&#9654;';
                    });

                    // Add event listeners for goal difficulty radio buttons
                    listItem.querySelectorAll(`input[name="goalDifficulty${index}"]`).forEach(radio => {
                        radio.addEventListener('change', (event) => {
                            const value = event.target.value;
                            const description = goalDescriptions[value];
                            document.getElementById(`goalDescription${index}`).innerText = description;
                        });
                    });

                    problemsList.appendChild(listItem);
                });
            }
        }

        function addGoal(problemIndex) {
            const goalInput = document.getElementById(`goalInput${problemIndex}`).value;
            const goalArea = document.getElementById(`goalArea${problemIndex}`).value;
            const goalEmotion = document.getElementById(`goalEmotion${problemIndex}`).value;
            const goalDifficulty = document.querySelector(`input[name="goalDifficulty${problemIndex}"]:checked`).value;
            const goal = { goalInput, goalArea, goalEmotion, goalDifficulty };
            let goals = JSON.parse(localStorage.getItem('goals')) || [];
            goals.push(goal);
            localStorage.setItem('goals', JSON.stringify(goals));
            alert('Goal added to list.');
            renderGoalsList();
        }

        function deleteProblem(index) {
            let problems = JSON.parse(localStorage.getItem('problems')) || [];
            problems.splice(index, 1);
            localStorage.setItem('problems', JSON.stringify(problems));
            renderProblemsList();
        }

        function renderGoalsList() {
            const goals = JSON.parse(localStorage.getItem('goals')) || [];
            const goalsList = document.getElementById('goalsList');
            goalsList.innerHTML = '';
            if (goals.length === 0) {
                goalsList.innerHTML = '<li>Use section 2 to add goals to list</li>';
            } else {
                goals.forEach((goal, index) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-item';
                    listItem.innerHTML = `
                        <div class="list-item-title">
                            <span>${goal.goalInput}</span>
                            <span>&#9654;</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <div>
                                <br>
                                Area: ${goal.goalArea}<br>
                                Emotion: ${goal.goalEmotion}<br>
                                Difficulty: ${goal.goalDifficulty}<br>
                            </div>
                        </div>
                        <hr>
                        <div class="list-item-content">
                            <label>Task: <input type="text" id="taskInput${index}"></label>
                            <button type="button" class="add-button" onclick="addTask(${index})">Add</button>
<hr>
<button class="delete-button" type="button" onclick="deleteGoal(${index})"><strong>Delete</strong></button>
                        </div>
                    `;
                    listItem.querySelector('.list-item-title').addEventListener('click', () => {
                        const content = listItem.querySelector('.list-item-content');
                        const arrow = listItem.querySelector('.list-item-title span:last-child');
                        content.classList.toggle('active');
                        arrow.innerHTML = content.classList.contains('active') ? '&#9650;' : '&#9654;';
                    });

                    goalsList.appendChild(listItem);
                });
            }
        }

        function deleteGoal(index) {
            let goals = JSON.parse(localStorage.getItem('goals')) || [];
            goals.splice(index, 1);
            localStorage.setItem('goals', JSON.stringify(goals));
            renderGoalsList();
        }

        function addTask(goalIndex) {
            const taskInput = document.getElementById(`taskInput${goalIndex}`).value;
            const task = { taskInput };
            let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            tasks.push(task);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            alert('Task added to list.');
            renderTasksList();
        }

        function renderTasksList() {
            const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            const tasksList = document.getElementById('tasksList');
            tasksList.innerHTML = '';
            if (tasks.length === 0) {
                tasksList.innerHTML = '<li>Use section 3 to add tasks to list</li>';
            } else {
                tasks.forEach((task, index) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-item';
                    listItem.innerHTML = `
                        <div class="list-item-title">
                        
                            <span>${task.taskInput}</span>
                            <span>&#9654;</span>
                        </div>
                        <div class="list-item-content">
                            <hr>
                            <span>
                            <label>Add to Calendar: <button class="add-Calendar" type="button" onclick="addToCalendar('${task.taskInput}')"><i class="fa fa-calendar"></i></button></label>
                            </span>
                            <hr>
                            <label>Materials: <textarea id="materialsInput${index}">${task.materialsInput || ''}</textarea></label>
                            <label>Cooperation Needed: <textarea id="cooperationInput${index}">${task.cooperationInput || ''}</textarea></label>
                            <label>Knowledge Required: <textarea id="knowledgeInput${index}">${task.knowledgeInput || ''}</textarea></label>
                            <span>
                            <button type="button" class="add-button" onclick="saveTask(${index})">Save</button></span>
                            <hr>
    <button class="delete-button" type="button" onclick="deleteTask(${index})"><strong>Delete</strong></button>
                        </div>
                    `;
                    listItem.querySelector('.list-item-title').addEventListener('click', () => {
                        const content = listItem.querySelector('.list-item-content');
                        const arrow = listItem.querySelector('.list-item-title span:last-child');
                        content.classList.toggle('active');
                        arrow.innerHTML = content.classList.contains('active') ? '&#9650;' : '&#9654;';
                    });

                    tasksList.appendChild(listItem);
                });
            }
        }

        function deleteTask(index) {
            let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            tasks.splice(index, 1);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            renderTasksList();
        }

        function saveTask(index) {
            const tasks = JSON.parse(localStorage.getItem('tasks')) || [];

            // Get the current task to preserve its title
            const task = tasks[index];

            const materialsInput = document.getElementById(`materialsInput${index}`).value;
            const cooperationInput = document.getElementById(`cooperationInput${index}`).value;
            const knowledgeInput = document.getElementById(`knowledgeInput${index}`).value;

            // Update task with new inputs
            task.materialsInput = materialsInput;
            task.cooperationInput = cooperationInput;
            task.knowledgeInput = knowledgeInput;

            tasks[index] = task;
            localStorage.setItem('tasks', JSON.stringify(tasks));
            alert('Task saved.');
            renderTasksList();
        }

        function addToCalendar(taskName) {
            const date = new Date().toISOString().split('T')[0]; // default to today's date
            const time = 'T090000'; // default time
            const formattedDateTime = `${date}${time}`;
            const calendarUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(taskName)}&dates=${formattedDateTime}/${formattedDateTime}`;

            window.open(calendarUrl, '_blank');
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderProblemsList();
            renderGoalsList();
            renderTasksList();
        });

        function sortProblems(criteria) {
            let problems = JSON.parse(localStorage.getItem('problems')) || [];

            if (criteria === 'recent') {
                problems = problems.reverse(); // Assuming problems are added chronologically
            } else if (criteria === 'area') {
                problems.sort((a, b) => a.problemArea.localeCompare(b.problemArea));
            } else if (criteria === 'emotion') {
                problems.sort((a, b) => a.problemEmotion.localeCompare(b.problemEmotion));
            } else if (criteria === 'difficulty') {
                problems.sort((a, b) => a.problemDifficulty - b.problemDifficulty);
            }

            localStorage.setItem('problems', JSON.stringify(problems));
            renderProblemsList();
            setActiveSortButton('problems', criteria);
        }

        function sortGoals(criteria) {
            let goals = JSON.parse(localStorage.getItem('goals')) || [];

            if (criteria === 'recent') {
                goals = goals.reverse(); // Assuming goals are added chronologically
            } else if (criteria === 'area') {
                goals.sort((a, b) => a.goalArea.localeCompare(b.goalArea));
            } else if (criteria === 'emotion') {
                goals.sort((a, b) => a.goalEmotion.localeCompare(b.goalEmotion));
            } else if (criteria === 'difficulty') {
                goals.sort((a, b) => a.goalDifficulty - b.goalDifficulty);
            }

            localStorage.setItem('goals', JSON.stringify(goals));
            renderGoalsList();
            setActiveSortButton('goals', criteria);
        }

        function setActiveSortButton(section, criteria) {
            document.querySelectorAll(`#section${section === 'problems' ? 2 : 3} .sort-buttons button`).forEach(button => {
                button.classList.remove('active');
            });
            document.querySelector(`#section${section === 'problems' ? 2 : 3} .sort-buttons button[onclick="sort${capitalize(section)}('${criteria}')"]`).classList.add('active');
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }
    </script>
</body>
</html>