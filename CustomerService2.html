
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDRC Customer Service Call Flow - New Hire Mode</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'base',
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 40,
                rankSpacing: 60,
                padding: 20
            },
            themeVariables: {
                primaryColor: '#e3f2fd',
                secondaryColor: '#fff3e0',
                tertiaryColor: '#e8f5e9',
                fontSize: '15px',
                fontFamily: 'Segoe UI, Arial, sans-serif',
                lineColor: '#546e7a'
            }
        });
        // Expose mermaid to window so we can access it if needed
        window.mermaid = mermaid;
    </script>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f6f8; height: 100vh; display: flex; flex-direction: column; }
        
        /* Header */
        header { background: #2c3e50; color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { margin: 0; font-size: 22px; font-weight: 600; }
        .subtitle { font-size: 13px; opacity: 0.8; }
        
        /* Layout */
        .main-layout { display: flex; flex: 1; overflow: hidden; }
        
        /* Sidebar (Legend & Systems) */
        .sidebar { width: 300px; background: white; border-right: 1px solid #e0e0e0; overflow-y: auto; display: flex; flex-direction: column; z-index: 10; }
        .sidebar-section { padding: 20px; border-bottom: 1px solid #eee; }
        .sidebar-title { font-size: 14px; font-weight: 700; color: #34495e; text-transform: uppercase; margin-bottom: 15px; letter-spacing: 0.5px; }
        
        /* System List */
        .system-item { display: flex; align-items: baseline; margin-bottom: 12px; font-size: 13px; }
        .system-name { font-weight: 700; color: #2980b9; width: 80px; flex-shrink: 0; }
        .system-desc { color: #555; }
        
        /* Diagram Area */
        .diagram-wrapper { flex: 1; position: relative; background-color: #f4f6f8; overflow: hidden; }
        .diagram-container { width: 100%; height: 100%; overflow: hidden; cursor: grab; display: flex; align-items: center; justify-content: center; }
        .diagram-container:active { cursor: grabbing; }
        
        /* Controls */
        .controls-overlay { position: absolute; bottom: 30px; right: 30px; background: white; padding: 10px; border-radius: 50px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: flex; gap: 10px; z-index: 100; }
        .btn-control { width: 40px; height: 40px; border-radius: 50%; border: none; background: #fff; color: #555; font-size: 18px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .btn-control:hover { background: #2980b9; color: white; }
        .btn-save { background: #e8f5e9; color: #2e7d32; }
        .btn-save:hover { background: #2e7d32; color: white; }

        /* Mermaid Specifics */
        .mermaid { transform-origin: center center; }
        
        /* Instructions Panel (Bottom of sidebar) */
        .quick-tips { background: #fff8e1; padding: 15px; margin: 20px; border-radius: 8px; border-left: 4px solid #ffb300; font-size: 13px; }
        
    </style>
</head>
<body>

    <header>
        <div>
            <h1>SDRC Customer Service Flow</h1>
            <div class="subtitle">Interactive Support Tool v2.0</div>
        </div>
        <div style="font-size: 13px; background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 20px;">
            Current Zoom: <span id="zoomLevel">100</span>%
        </div>
    </header>

    <div class="main-layout">
        
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">üîë Key Systems</div>
                <div class="system-item"><span class="system-name">Merit</span> <span class="system-desc">Request Management (Logs & Tasks)</span></div>
                <div class="system-item"><span class="system-name">TechOne</span> <span class="system-desc">Finance & Property Data</span></div>
                <div class="system-item"><span class="system-name">Intramaps</span> <span class="system-desc">GIS / Maps / Zones</span></div>
                <div class="system-item"><span class="system-name">ECM</span> <span class="system-desc">Document Management</span></div>
                <div class="system-item"><span class="system-name">Aqualas</span> <span class="system-desc">Water Networks</span></div>
                <div class="system-item"><span class="system-name">BPOINT</span> <span class="system-desc">Taking Payments</span></div>
                <div class="system-item"><span class="system-name">Payreq</span> <span class="system-desc">Rates Notices</span></div>
                <div class="system-item"><span class="system-name">Eli</span> <span class="system-desc">Internal Knowledge Base</span></div>
                <div class="system-item"><span class="system-name">The Pulse</span> <span class="system-desc">Staff Directory</span></div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">üìû Critical Numbers</div>
                <div class="system-item"><span class="system-name">RSPCA</span> <span class="system-desc">1300 264 625</span></div>
                <div class="system-item"><span class="system-name">QLD Rail</span> <span class="system-desc">13 16 17</span></div>
                <div class="system-item"><span class="system-name">TMR</span> <span class="system-desc">13 20 80</span></div>
                <div class="system-item"><span class="system-name">Vicki L.</span> <span class="system-desc">0427 026 216 (Washpool)</span></div>
            </div>
            
            <div class="quick-tips">
                <b>üí° New Hire Tips:</b>
                <ul style="margin: 5px 0 0 0; padding-left: 20px;">
                    <li>Never cold transfer. Announce the caller.</li>
                    <li>Always verify identity for Rates/Private info.</li>
                    <li>If unsure, ask to put customer on brief hold.</li>
                </ul>
            </div>
        </aside>

        <div class="diagram-wrapper">
            <div class="controls-overlay">
                <button class="btn-control" onclick="zoomIn()" title="Zoom In">Ôºã</button>
                <button class="btn-control" onclick="resetZoom()" title="Reset View">‚ü≤</button>
                <button class="btn-control" onclick="zoomOut()" title="Zoom Out">Ôºç</button>
                <div style="width: 1px; background: #eee; height: 25px;"></div>
                <button class="btn-control btn-save" onclick="saveImage()" title="Save High-Res Image">üì∑</button>
            </div>

            <div class="diagram-container" id="diagramContainer">
                <div class="mermaid" id="mermaidDiagram">
flowchart TD
    %% --- STYLING ---
    classDef startNode fill:#2e7d32,stroke:#1b5e20,stroke-width:3px,color:white,font-size:16px,font-weight:bold;
    classDef routerNode fill:#ff9800,stroke:#e65100,stroke-width:2px,color:white,font-weight:bold;
    classDef subRouter fill:#ffe0b2,stroke:#f57c00,stroke-width:2px,color:#333;
    classDef actionNode fill:#ffffff,stroke:#607d8b,stroke-width:1px,color:#333,text-align:left;
    classDef stopNode fill:#c62828,stroke:#b71c1c,stroke-width:2px,color:white,font-weight:bold;
    classDef systemNode fill:#e1f5fe,stroke:#0277bd,stroke-width:2px,color:#01579b;

    %% --- THE FLOW ---

    Start([Incoming Call]) --> Greeting["<b>üó£Ô∏è GREETING</b><br/><i>'SDRC, this is [Name] speaking.<br/>How can I help you today?'</i>"]
    
    Greeting --> Verify["<b>üïµÔ∏è VERIFY & IDENTIFY</b><br/>1. Listen to reason<br/>2. <b>Verify Identity</b>"]
    
    Verify --> MainRoute{CATEGORY?}

    %% ==========================================
    %% GROUP 1: ANIMALS (Broken down for clarity)
    %% ==========================================
    MainRoute -->|Animals| AnimalSplit{üêï Issue Type?}
    
    subgraph SG_Animals [üêï ANIMAL SERVICES]
        direction TB
        AnimalSplit --Lost/Impound--> Anim_Lost["<b>Lost & Found</b><br/>1. Add to <i>S:\Customer Service\Shared All\Animals ‚Äì Lost/Found Register</i><br/>2. Notify CS Group + Local Laws<br/><br/><b>Impounded</b><br/>1. Check <i>S:\Shared All\Animals ‚Äì Impoundments</i><br/>2. Contact Local Laws Officer<br/>3. Arrange collection & release fee"]
        
        AnimalSplit --Registration--> Anim_Reg["<b>Dog Registration</b><br/>‚Ä¢ Email Form: <i>Application for Dog Registration</i><br/>‚Ä¢ Request: Proof of Desexing, Pension Card, Breeder Supply #"]
        
        AnimalSplit --Barking--> Anim_Bark["<b>Barking Dogs (NEW)</b><br/>1. Encourage direct contact (letter template)<br/>2. Merit 'Barking' (Give #)<br/>3. Provide Fact Sheet + Diary<br/>4. Email diary to mail@sdrc.qld.gov.au<br/><br/><b>Barking (ONGOING)</b><br/>‚Ä¢ Add note to Merit w/ return phone #"]
        
        AnimalSplit --Cruelty--> Anim_RSPCA["<b>Cruelty & Welfare</b><br/>üö® Direct to <b>RSPCA: 1300 264 625</b>"]
        
        AnimalSplit --Attack--> Anim_Attack["<b>‚ö†Ô∏è DOG ATTACK</b><br/>Merit 'attack' ‚Äî Record:<br/>‚Ä¢ Danger present? Dog location?<br/>‚Ä¢ Medical treatment needed?<br/>‚Ä¢ Date/Time/Location<br/>üìß Email: <i>Statement of Dog Attack Form</i>"]
        
        AnimalSplit --Other--> Anim_Gen["<b>Straying:</b> Merit 'Stray' (Loc, Breed, Time)<br/><b>Pest Animals:</b> Search Website Factsheets<br/><b>Surrender:</b> Email 'Owners Consent' form + Take Fee"]
    end

    %% ==========================================
    %% GROUP 2: PROPERTY & PLANNING
    %% ==========================================
    MainRoute -->|Building/Plumb| PropSplit{üèóÔ∏è Issue Type?}
    
    subgraph SG_Property [üèóÔ∏è PROPERTY & PLANNING]
        direction TB
        PropSplit --Building--> Prop_Build["<b>BUILDING</b><br/><b>New:</b> Factsheets + Callback (Merit 'Building')<br/><b>Existing:</b> Transfer to person OR Merit 'Building'<br/><b>Inspections:</b> Email <i>buildinginspections@sdrc</i>"]
        
        PropSplit --Plumbing--> Prop_Plumb["<b>PLUMBING</b><br/><b>New:</b> FAQ + Callback (Merit 'Plumbing')<br/><b>Existing:</b> Transfer OR Merit 'Plumbing'<br/><b>Inspections:</b> Check Cal -> Add -> Notify <i>plumbinginspections@sdrc</i>"]
        
        PropSplit --Water/Sewer--> Prop_Conn["<b>CONNECT WATER/SEWER</b><br/>Check <b>Intramaps</b> (Water Module)<br/><b>Standard?</b> (100m from main, Vacant charge, Catchment, Single lot)<br/>‚úÖ YES: Email 'App for Water/Sewer'<br/>‚ùå NO: Email 'Private Works Water/Sewer'"]
        
        PropSplit --Leak--> Prop_Leak["<b>üíß WATER LEAK</b><br/>Check <b>Aqualas</b><br/><b>Council Side:</b> Merit 'Leak' -> Maint. Super<br/><b>Customer Side:</b> Advise Plumber"]
    end
    
    MainRoute -->|Planning| Plan["<b>üó∫Ô∏è PLANNING</b><br/><b>New:</b> Factsheets + Callback (Merit 'Planning')<br/><b>App/General:</b> Take Info -> Merit 'Planning' -> Transfer to <b>Duty Planner</b><br/><i>If unavail: Wait for callback (Max 5 days)</i>"]

    %% ==========================================
    %% GROUP 3: FINANCE & RATES
    %% ==========================================
    MainRoute -->|Rates/Pay| FinSplit{üí∞ Issue Type?}

    subgraph SG_Finance [üí∞ FINANCE]
        FinSplit --Rates--> Fin_Rates["<b>RATES (Check ID!)</b><br/><b>Pay:</b> Check TechOne Balance -> BPOINT<br/><b>Copy:</b> Intramaps ID -> Payreq -> Email PDF<br/><b>Direct Debit:</b> Email DD Request Form<br/><b>Pension:</b> Email Pension Subsidy App"]
        
        FinSplit --Payment--> Fin_Pay["<b>GENERAL PAYMENT</b><br/><b>BPOINT Fields:</b><br/>1. Name  2. Address  3. Purpose<br/>Ref: Property ID or Licence #<br/><i>Check fees in LivePro or TechOne</i>"]
        
        FinSplit --Licences--> Fin_Lic["<b>LICENCES</b><br/><b>Renew:</b> BPOINT (Ref: Lic #)<br/><b>Apply:</b> Eli 'Forms' -> Email to customer"]
    end

    %% ==========================================
    %% GROUP 4: INFRASTRUCTURE & WASTE
    %% ==========================================
    MainRoute -->|Waste| WasteSplit{üóëÔ∏è Issue Type?}
    
    subgraph SG_Waste [üóëÔ∏è WASTE SERVICES]
        WasteSplit --Bins--> Waste_Bins["<b>RESIDENTIAL BINS</b><br/><b>Missed/Broken:</b> Confirm details -> Lodge <b>Cleanaway</b> Request<br/><i>(Leave bin on curb)</i><br/><b>Missing:</b> Lodge Cleanaway Request"]
        
        WasteSplit --Public--> Waste_Public["<b>PUBLIC BINS</b><br/>Check Intramaps:<br/>‚Ä¢ If Cleanaway icon: Lodge Cleanaway<br/>‚Ä¢ If not: Merit 'Maintenance'"]
        
        WasteSplit --Complaint--> Waste_Comp["<b>COMPLAINTS</b><br/>Merit 'Complaint' -> Bins/Collection"]
    end

    MainRoute -->|Roads| Roads["<b>üõ£Ô∏è ROADS</b><br/><b>Closures:</b> Check Disaster Dashboard<br/><b>Hwy:</b> TMR (13 20 80)<br/><b>Rail:</b> Qld Rail (13 16 17)<br/><b>Potholes:</b> Merit 'Pothole' (Sealed/Unsealed?)<br/><b>Road Kill:</b> >100kg (Merit 'Dead') / &lt;100kg (Cleanaway)"]

    %% ==========================================
    %% GROUP 5: GENERAL / OTHER
    %% ==========================================
    MainRoute -->|General| GenSplit{Other?}
    
    GenSplit --Camp/Cross--> Camp["<b>‚õ∫ CAMPGROUNDS</b><br/><b>Washpool:</b> Eli 'Washpool' (Vicki: 0427 026 216)<br/><b>Connolly Dam:</b> Self-register on site<br/><b>Condamine Rd:</b> Check Disaster Dashboard"]
    
    GenSplit --Env Health--> Env["<b>üçÉ ENV HEALTH</b><br/>1. Check Jurisdiction (Eli)<br/>2. If Council: Merit 'Environment'<br/>3. Ongoing? Email 'Nuisance Diary'"]
    
    GenSplit --Complaints--> Comp["<b>üò° COMPLAINTS</b><br/><b>Service:</b> Merit 'Complaint'<br/><b>Formal:</b> Email Form 'Complaint Form'<br/><b>Alt:</b> Email mail@sdrc (Attn: Name)"]
    
    GenSplit --Disputes--> Disp["<b>ü§ù DISPUTES</b><br/><b>Noise/Smell:</b> See Env Health<br/><b>Animals:</b> See Animals<br/><b>Private:</b> Refer to QCAT"]
    
    GenSplit --Transfers--> Trans["<b>‚òéÔ∏è TRANSFERS</b><br/>1. Search <b>The Pulse</b> or <b>Eli</b><br/>2. Warm Transfer (announce caller)<br/>3. If unavail: Merit Callback"]

    %% --- TERMINATORS ---
    Anim_Lost & Anim_Reg & Anim_Bark & Anim_RSPCA & Anim_Attack & Anim_Gen --> Close(["<b>üëã CLOSE CALL</b><br/><i>'Is there anything else I can help with?'</i>"])
    Prop_Build & Prop_Plumb & Prop_Conn & Prop_Leak & Plan --> Close
    Fin_Rates & Fin_Pay & Fin_Lic --> Close
    Waste_Bins & Waste_Public & Waste_Comp & Roads --> Close
    Camp & Env & Comp & Disp & Trans --> Close

    %% --- CLASS ASSIGNMENT ---
    class Start startNode;
    class MainRoute,AnimalSplit,PropSplit,FinSplit,WasteSplit,GenSplit routerNode;
    class Close stopNode;
    class Anim_Lost,Anim_Reg,Anim_Bark,Anim_RSPCA,Anim_Attack,Anim_Gen actionNode;
    class Prop_Build,Prop_Plumb,Prop_Conn,Prop_Leak,Plan actionNode;
    class Fin_Rates,Fin_Pay,Fin_Lic actionNode;
    class Waste_Bins,Waste_Public,Waste_Comp,Roads actionNode;
    class Camp,Env,Comp,Disp,Trans actionNode;
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentZoom = 100;
        const minZoom = 25;
        const maxZoom = 200;
        const zoomStep = 15;
        
        // Panning Variables
        let isPanning = false;
        let startX = 0;
        let startY = 0;
        let panX = 0;
        let panY = 0;

        function updateTransform() {
            const mermaid = document.getElementById('mermaidDiagram');
            mermaid.style.transform = `translate(${panX}px, ${panY}px) scale(${currentZoom / 100})`;
            document.getElementById('zoomLevel').textContent = currentZoom;
        }
        
        function zoomIn() {
            if (currentZoom < maxZoom) {
                currentZoom += zoomStep;
                updateTransform();
            }
        }
        
        function zoomOut() {
            if (currentZoom > minZoom) {
                currentZoom -= zoomStep;
                updateTransform();
            }
        }
        
        function resetZoom() {
            currentZoom = 100;
            panX = 0;
            panY = 0;
            updateTransform();
        }

        // SAVE IMAGE FUNCTION
        function saveImage() {
            const mermaidDiv = document.querySelector('.mermaid');
            const svg = mermaidDiv.querySelector('svg');
            
            if (!svg) {
                alert('Diagram not loaded yet. Please wait a moment.');
                return;
            }

            // Get SVG data
            const serializer = new XMLSerializer();
            let source = serializer.serializeToString(svg);

            // Add namespaces if missing (prevents some browser errors)
            if(!source.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)){
                source = source.replace(/^<svg/, '<svg xmlns="http://www.w3.org/2000/svg"');
            }
            if(!source.match(/^<svg[^>]+xmlns:xlink="http\:\/\/www\.w3\.org\/1999\/xlink"/)){
                source = source.replace(/^<svg/, '<svg xmlns:xlink="http://www.w3.org/1999/xlink"');
            }

            // Prepare Canvas
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            const svgSize = svg.getBoundingClientRect();
            
            // SCALE FACTOR (increase this for higher resolution)
            const scaleFactor = 3; 

            canvas.width = svgSize.width * scaleFactor;
            canvas.height = svgSize.height * scaleFactor;

            const img = new Image();
            img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(source)));

            img.onload = function() {
                // Fill white background (otherwise it's transparent)
                context.fillStyle = '#ffffff';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw image scaled
                context.drawImage(img, 0, 0, canvas.width, canvas.height);
                
                // Trigger Download
                const a = document.createElement('a');
                a.download = 'SDRC_Call_Flow.png';
                a.href = canvas.toDataURL('image/png');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            };
        }

        // Mouse Wheel Zoom
        document.getElementById('diagramContainer').addEventListener('wheel', function(e) {
            if (e.ctrlKey || e.metaKey) {
                e.preventDefault();
                if (e.deltaY < 0) zoomIn();
                else zoomOut();
            }
        });

        // Panning Logic
        const container = document.getElementById('diagramContainer');

        container.addEventListener('mousedown', (e) => {
            isPanning = true;
            startX = e.clientX - panX;
            startY = e.clientY - panY;
            container.style.cursor = 'grabbing';
        });

        window.addEventListener('mouseup', () => {
            isPanning = false;
            container.style.cursor = 'grab';
        });

        window.addEventListener('mousemove', (e) => {
            if (!isPanning) return;
            e.preventDefault();
            panX = e.clientX - startX;
            panY = e.clientY - startY;
            updateTransform();
        });
    </script>
</body>
</html>

