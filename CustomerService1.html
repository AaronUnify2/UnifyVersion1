<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDRC Customer Service Call Flow Chart</title>
    <!-- dom-to-image library for proper SVG/foreignObject rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 50,
                rankSpacing: 80
            },
            themeVariables: {
                fontSize: '14px',
                fontFamily: 'Arial, sans-serif'
            }
        });
    </script>
    <style>
        /* A3 Print Setup */
        @page {
            size: A3 landscape;
            margin: 10mm;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f4f8;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
        
        h1 {
            color: #1a365d;
            text-align: center;
            margin-bottom: 5px;
            font-size: 28px;
        }
        
        h3 {
            color: #1a365d;
            margin-top: 0;
        }
        
        .subtitle {
            text-align: center;
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        /* Zoom Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .controls button {
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            border: 2px solid #3182ce;
            background-color: white;
            color: #3182ce;
            border-radius: 6px;
            transition: all 0.2s;
            font-weight: 600;
        }
        
        .controls button:hover {
            background-color: #3182ce;
            color: white;
        }
        
        .controls button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .controls button.print-btn {
            border-color: #38a169;
            color: #38a169;
        }
        
        .controls button.print-btn:hover {
            background-color: #38a169;
            color: white;
        }
        
        .controls button.poster-btn {
            border-color: #805ad5;
            color: #805ad5;
        }
        
        .controls button.poster-btn:hover {
            background-color: #805ad5;
            color: white;
        }
        
        .controls button.quad-btn {
            border-color: #dd6b20;
            color: #dd6b20;
        }
        
        .controls button.quad-btn:hover {
            background-color: #dd6b20;
            color: white;
        }
        
        .zoom-info {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background-color: #ebf8ff;
            border-radius: 6px;
            color: #2b6cb0;
            font-weight: 500;
        }
        
        /* Poster Size Selector */
        .poster-options {
            display: none;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f3e8ff;
            border-radius: 8px;
            border: 2px solid #805ad5;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .poster-options.show {
            display: flex;
        }
        
        .poster-options label {
            font-weight: 600;
            color: #553c9a;
        }
        
        .poster-options select {
            padding: 8px 12px;
            font-size: 14px;
            border: 2px solid #805ad5;
            border-radius: 6px;
            background-color: white;
            color: #553c9a;
            cursor: pointer;
        }
        
        .poster-options button {
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            border: 2px solid #805ad5;
            background-color: #805ad5;
            color: white;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .poster-options button:hover {
            background-color: #6b46c1;
        }
        
        .poster-options button.cancel-btn {
            background-color: white;
            color: #805ad5;
        }
        
        .poster-options button.cancel-btn:hover {
            background-color: #f3e8ff;
        }
        
        .poster-status {
            color: #553c9a;
            font-size: 14px;
            min-width: 200px;
        }
        
        /* Quadrant print status */
        .quad-status {
            display: none;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #feebc8;
            border-radius: 8px;
            border: 2px solid #dd6b20;
            flex-wrap: wrap;
            align-items: center;
            color: #c05621;
            font-weight: 500;
        }
        
        .quad-status.show {
            display: flex;
        }
        
        /* Diagram Container */
        .diagram-wrapper {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            background-color: #fafafa;
            margin-bottom: 30px;
        }
        
        .diagram-container {
            width: 100%;
            height: 75vh;
            min-height: 600px;
            overflow: auto;
            padding: 20px;
            cursor: grab;
        }
        
        .diagram-container:active {
            cursor: grabbing;
        }
        
        .mermaid {
            transform-origin: top left;
            transition: transform 0.2s ease;
        }
        
        /* Info Box Styles */
        .info-section {
            margin-top: 30px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #ebf8ff 0%, #e6fffa 100%);
            border-left: 5px solid #3182ce;
            padding: 20px 25px;
            margin-bottom: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .info-box h3 {
            margin-top: 0;
            color: #2c5282;
            font-size: 18px;
            margin-bottom: 12px;
        }
        
        .info-box p {
            margin: 8px 0;
            font-size: 14px;
            color: #2d3748;
            line-height: 1.6;
        }
        
        /* Instructions Panel */
        .instructions {
            background-color: #fffaf0;
            border: 1px solid #ed8936;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 20px;
        }
        
        .instructions h4 {
            margin: 0 0 10px 0;
            color: #c05621;
            font-size: 14px;
        }
        
        .instructions ul {
            margin: 0;
            padding-left: 20px;
            font-size: 13px;
            color: #744210;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
        
        /* Mermaid Node Styling */
        .mermaid .node rect {
            rx: 8px;
            ry: 8px;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            color: #718096;
            font-size: 12px;
        }
        
        /* ========================================
           A3 PRINT STYLES - OPTIMIZED FOR PRINTING
           ======================================== */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            html, body {
                width: 420mm;
                height: 297mm;
                margin: 0 !important;
                padding: 0 !important;
                background-color: white !important;
                overflow: visible !important;
            }
            
            body {
                padding: 5mm !important;
            }
            
            .container {
                box-shadow: none !important;
                padding: 5mm !important;
                margin: 0 !important;
                max-width: none !important;
                width: 100% !important;
                border-radius: 0 !important;
                page-break-inside: avoid;
            }
            
            .controls,
            .instructions,
            .zoom-info,
            .poster-options,
            .quad-status {
                display: none !important;
            }
            
            h1 {
                font-size: 22px !important;
                margin-bottom: 3mm !important;
                margin-top: 0 !important;
            }
            
            .subtitle {
                font-size: 11px !important;
                margin-bottom: 5mm !important;
            }
            
            .diagram-wrapper {
                border: 1px solid #ccc !important;
                border-radius: 0 !important;
                margin-bottom: 5mm !important;
                page-break-inside: avoid;
            }
            
            .diagram-container {
                height: auto !important;
                min-height: auto !important;
                max-height: none !important;
                overflow: visible !important;
                padding: 3mm !important;
                width: 100% !important;
            }
            
            .mermaid {
                transform: scale(0.45) !important;
                transform-origin: top left !important;
                width: 220% !important;
                max-width: none !important;
            }
            
            .mermaid svg {
                max-width: none !important;
                overflow: visible !important;
            }
            
            .info-section {
                margin-top: 3mm !important;
                page-break-inside: avoid;
            }
            
            .info-box {
                padding: 8px 12px !important;
                margin-bottom: 3mm !important;
                page-break-inside: avoid;
                background: #f0f8ff !important;
                border-left: 4px solid #3182ce !important;
            }
            
            .info-box h3 {
                font-size: 12px !important;
                margin-bottom: 5px !important;
            }
            
            .info-box p {
                font-size: 9px !important;
                margin: 3px 0 !important;
                line-height: 1.4 !important;
            }
            
            .footer {
                margin-top: 3mm !important;
                padding-top: 3mm !important;
                font-size: 9px !important;
                page-break-inside: avoid;
            }
            
            .footer p:last-child {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <h1>SDRC Customer Service Call Flow Chart</h1>
        <p class="subtitle">Decision Tree Model ‚Äì Autonomy-Focused Guidance</p>
        
        <div class="controls">
            <button onclick="zoomIn()">‚ûï Zoom In</button>
            <button onclick="zoomOut()">‚ûñ Zoom Out</button>
            <button onclick="resetZoom()">üîÑ Reset View</button>
            <button onclick="fitToScreen()">üìê Fit to Screen</button>
            <button onclick="window.print()" class="print-btn">üñ®Ô∏è Print A3</button>
            <button onclick="printAs6xA4()" class="quad-btn">üìÑ Print 6√ó A4 Poster</button>
            <button onclick="showPosterOptions()" class="poster-btn">üñºÔ∏è Save as Image</button>
            <div class="zoom-info">Zoom: <span id="zoomLevel">100</span>%</div>
        </div>
        
        <div class="quad-status" id="quadStatus">
            <span id="quadStatusText">‚è≥ Generating 6√ó A4 poster pages...</span>
        </div>
        
        <div class="poster-options" id="posterOptions">
            <label for="posterSize">Image Size:</label>
            <select id="posterSize">
                <option value="1">Standard (1x) - Fastest</option>
                <option value="2" selected>Large (2x) - Recommended</option>
                <option value="3">Extra Large (3x)</option>
                <option value="4">Poster (4x) - May be slow</option>
            </select>
            <button onclick="savePosterImage()">üíæ Download PNG</button>
            <button onclick="hidePosterOptions()" class="cancel-btn">Cancel</button>
            <span class="poster-status" id="posterStatus"></span>
        </div>
        
        <div class="instructions">
            <h4>üñ®Ô∏è Printing &amp; Export Options</h4>
            <ul>
                <li><b>Print A3:</b> Direct print to A3 paper (landscape)</li>
                <li><b>Print 6√ó A4 Poster:</b> Splits diagram into 6 A4 pages (3√ó2) ‚Äî print and tape together for a large poster!</li>
                <li><b>Save as Image:</b> Download as high-resolution PNG for professional printing or digital use</li>
            </ul>
        </div>

        <div class="diagram-wrapper">
            <div class="diagram-container" id="diagramContainer">
                <div class="mermaid" id="mermaidDiagram">
flowchart TD
    Start(["üìû Incoming Call"]) --> Greeting["<b>GREETING</b><br/><i>SDRC, this is Name speaking.<br/>How can I help you today?</i>"]
    
    Greeting --> Verify["<b>VERIFY &amp; IDENTIFY</b><br/>1. Listen to reason for calling<br/>2. Verify customer identity"]
    
    Verify --> Category{"<b>SERVICE CATEGORY?</b>"}
    
    Category -->|Property| PropDecision{"<b>PROPERTY ISSUE?</b>"}
    Category -->|Community| CommDecision{"<b>COMMUNITY?</b>"}
    Category -->|Infrastructure| InfraDecision{"<b>INFRASTRUCTURE ISSUE?</b>"}
    Category -->|Other| OtherDecision{"<b>OTHER ISSUE?</b>"}

    %% =============================================
    %% PROPERTY SERVICES
    %% =============================================

    %% --- RATES (2 nodes) ---
    PropDecision -->|Rates| RatesDecision{"Payment or Admin?"}
    RatesDecision -->|Payment| RatesPayment["<b>üí∞ RATES - Payment</b><br/><br/>1. Look up property: Intramaps/TechOne<br/>Confirm customer identity<br/>2. Use Property ID in TechOne<br/>Confirm balance owing<br/>3. Process payment in BPOINT<br/><br/>üìå Eli: Rates Process"]
    RatesDecision -->|Admin| RatesAdmin["<b>üí∞ RATES - Admin</b><br/><br/><u>Payment Agreement:</u><br/>1. Look up property on TechOne<br/>2. Check rate recovery code<br/>3. If General/FirstREM/FinalREM: proceed<br/>If else: view table on Eli for action<br/>4. Run XLOne report in TechOne<br/>5. Follow spreadsheet process with customer<br/>6. Save spreadsheet to pre-approved folder<br/>7. Email spreadsheet to revenue<br/>8. Customer awaits confirmation email<br/><br/><u>Copy of Rates Notice:</u><br/>Search Property ID in Payreq<br/>Email PDF to customer<br/>If previous FY: look up fee in Fees &amp; Charges<br/><br/><u>Direct Debit:</u><br/>New: Email Form - Direct Debit Request<br/>Alter: Email Form - DD Alteration/Cancellation<br/><br/><u>Pensioner Rates Subsidy:</u><br/>Email Form - Pension Subsidy Application<br/>Request proof of pension card<br/><br/>üìå Eli: Rates Process"]

    %% --- BUILDING (3 nodes: Inspection first, then Existing, New) ---
    PropDecision -->|Building| BuildingDecision{"Inspection, Existing,<br/>or New?"}
    BuildingDecision -->|Inspection| BuildingInspec["<b>üèóÔ∏è BUILDING - Inspection</b><br/><br/>Booking Building Inspections<br/>1. Follow Email Template<br/>2. Notify inspectors by email:<br/>sdrcbuilding@sdrc.qld.gov.au<br/><br/>üìå Eli: Building Inspections"]
    BuildingDecision -->|Existing| BuildingExist["<b>üèóÔ∏è BUILDING - Existing</b><br/><br/>Existing Application<br/>1. Transfer to relevant person<br/>2. If unavailable: Arrange callback<br/>Merit Building - Follow Process<br/>Provide customer with Merit #<br/><br/>üìå Eli: Building Applications"]
    BuildingDecision -->|New| BuildingNew["<b>üèóÔ∏è BUILDING - New</b><br/><br/>New Enquiry<br/>1. Provide Factsheets:<br/>Building Info Sheets - SDRC<br/>2. Arrange callback:<br/>Merit Building - Follow Process<br/>Provide customer with Merit #<br/><br/>üìå Eli: Building Info Sheets"]

    %% --- PLUMBING (5 nodes: New, Existing, Water/Sewer, Leak, Inspection last) ---
    PropDecision -->|Plumbing| PlumbingDecision{"Type?"}
    PlumbingDecision -->|New| PlumbNew["<b>üîß PLUMBING - New Enquiry</b><br/><br/>1. Provide FAQ: Plumbing Approvals - SDRC<br/>Regulated/minor work by licensed<br/>plumber and/or drainer. Plumber<br/>will apply for required approvals.<br/>2. If necessary arrange callback:<br/>Merit Plumbing - Follow Process<br/>Provide customer with Merit #<br/><br/>üìå Eli: Plumbing FAQ"]
    PlumbingDecision -->|Existing| PlumbExist["<b>üîß PLUMBING - Existing</b><br/><br/>Existing Application<br/>1. Transfer to relevant person<br/>2. If unavailable: Arrange callback<br/>Merit Plumbing - Follow Process<br/>Provide customer with Merit #<br/><br/>üìå Eli: Plumbing Applications"]
    PlumbingDecision -->|Water/Sewer| PlumbConnect["<b>üîß PLUMBING - Connections</b><br/><br/>Connect to Sewer/Water<br/>1. Check Intramaps Water &amp; Sewerage Module<br/>2. Standard or Non-Standard? All 4 = YES:<br/>‚òê Within 100m of 100mm main<br/>‚òê Has Vacant Access Charges<br/>‚òê In declared Catchment Area<br/>‚òê Single lot/duplex/secondary/subdivision<br/>3. If Standard: Email Form -<br/>Application for Water or Sewer Services<br/>4. If Non-Standard: Email Form -<br/>Private Works (Water &amp; Sewerage Forms - SDRC)<br/><br/>üìå Eli: Connections Guide"]
    PlumbingDecision -->|Water Leak| PlumbLeak["<b>üîß PLUMBING - Water Leak</b><br/><br/>1. Check Aqualas for leak location<br/>relative to water meter<br/>2. Council side: Merit Leak<br/>Contact Maintenance Supervisor<br/>3. Customer side: Advise contact plumber<br/><br/>üìå Eli: Water Leak Procedure"]
    PlumbingDecision -->|Inspection| PlumbInspec["<b>üîß PLUMBING - Inspection</b><br/><br/>Booking Plumbing Inspections<br/>1. Get: PD number, inspection type,<br/>structure type, location, start time<br/>2. Check plumbing inspector calendar<br/>Allow time for travel<br/>3. Add inspection to calendar<br/>4. Notify inspectors by email:<br/>sdrcplumbing@sdrc.qld.gov.au<br/><br/>üìå Eli: Plumbing Inspections"]

    %% --- PLANNING (3 nodes) ---
    PropDecision -->|Planning| PlanningDecision{"Type?"}
    PlanningDecision -->|New| PlanNew["<b>üìê PLANNING - New</b><br/><br/>New Enquiry<br/>1. Provide Factsheets:<br/>Planning Information Sheets - SDRC<br/>2. Arrange callback:<br/>Merit Planning - Follow Process<br/>Provide customer with Merit #<br/><br/>üìå Eli: Planning Info Sheets"]
    PlanningDecision -->|Existing| PlanExist["<b>üìê PLANNING - Existing</b><br/><br/>Existing Application<br/>1. Take info regarding query:<br/>Merit Planning - Follow Process<br/>Provide customer with Merit #<br/>2. Transfer to Duty Planner<br/>3. If unavailable: instruct customer<br/>to wait for callback - max 5 business days<br/><br/>üìå Eli: Planning Applications"]
    PlanningDecision -->|Payment| PlanPayment["<b>üìê PLANNING - Application Fee</b><br/><br/>Process payment in BPOINT<br/>Email receipt to:<br/>development@sdrc.qld.gov.au<br/><br/>üìå Eli: Planning Applications"]

    %% =============================================
    %% COMMUNITY SERVICES
    %% =============================================

    %% --- ANIMALS ---
    CommDecision -->|Animals| AnimalType{"Issue Type?"}
    AnimalType -->|Lost/Found| AnimalLost["<b>üêï ANIMALS - Lost/Found</b><br/><br/>Lost &amp; Found Cats, Dogs &amp; Other Animals<br/>1. Add to register:<br/>S:\Customer Service\Shared All\<br/>Animals - Lost and Found Register<br/>2. Notify CS Group + Local Laws by email<br/><br/>üìå Eli: Lost Animals Register"]
    AnimalType -->|Registration| AnimalReg["<b>üêï ANIMALS - Dog Registration</b><br/><br/>1. Email Form: Application for<br/>Dog Registration<br/>2. If applicable, request:<br/>Proof of Desexing<br/>Pension Card<br/>Dog Breeder Supply Number<br/><br/>üìå Eli: Dog Registration"]
    AnimalType -->|Impounded| AnimalImpound["<b>üêï ANIMALS - Impounded</b><br/><br/>1. Check register:<br/>S:\Customer Service\Shared All\Animals -<br/>Impoundments - Warwick - from 1 Jan 2019<br/>2. Contact Local Laws Officer to<br/>arrange collection<br/>3. Confirm release fee<br/><br/>üìå Eli: Impounded Animals"]
    AnimalType -->|Barking| BarkingType{"New or Ongoing?"}
    BarkingType -->|New| BarkNew["<b>üêï ANIMALS - Barking (New)</b><br/><br/>1. Strongly encourage direct contact<br/>with dog owner - letter template available<br/>2. Merit Barking - provide Merit #<br/>3. Provide barking dogs fact sheet +<br/>noise diary<br/>4. Instruct customer to email completed<br/>diary to mail@sdrc.qld.gov.au<br/>5. When diary received Local Laws<br/>will investigate<br/><br/>üìå Eli: Barking Procedure"]
    BarkingType -->|Ongoing| BarkOngo["<b>üêï ANIMALS - Barking (Ongoing)</b><br/><br/>1. Add note to existing Merit that<br/>another complaint has been received<br/>2. Include return phone number<br/><br/>üìå Eli: Barking Updates"]
    AnimalType -->|Surrender| AnimalSurrender["<b>üêï ANIMALS - Private Impoundment</b><br/><br/>Surrender of Dogs/Cats<br/>1. Email Form: Owners Consent to<br/>Privately Impound Dog or Cat<br/>2. Take impoundment fee over phone<br/>(Fees &amp; Charges: Private impounding)<br/>3. Email customer the receipt<br/>4. Email Local Laws the receipt<br/>5. Call Pound to arrange mutually<br/>suitable surrender time<br/><br/>üìå Eli: Private Impoundment"]
    AnimalType -->|Attack/Menacing| AnimalAttack["<b>üêï ANIMALS - Dog Attack/Menacing</b><br/><br/>Merit Attack - Record:<br/>Is customer still in danger of attack?<br/>Is the dog still in the area?<br/>Where exactly did the attack take place?<br/>When? (date and time)<br/>Was medical treatment required?<br/><br/>Email Form: Statement of Dog Attack Form<br/><br/>üìå Eli: Dog Attack Protocol"]
    AnimalType -->|Stray| AnimalStray["<b>üêï ANIMALS - Straying Dog</b><br/><br/>1. Merit Stray - Record:<br/>Location, Breed, Direction, Time<br/>2. Call Local Laws Officer to report<br/><br/>üìå Eli: Stray Dog Procedure"]
    AnimalType -->|Wildlife/Cruelty| AnimalWildlife["<b>üêï ANIMALS - Wildlife &amp; Cruelty</b><br/><br/><u>Animal Cruelty/Welfare:</u><br/>Direct to RSPCA: 1300 264 625<br/>or rspca.org.au/report-animal-cruelty<br/><br/><u>Wildlife Removal:</u><br/>Provide appropriate wildlife carer<br/>contact details to customer<br/><br/>üìå Eli: Animal Topics Index"]
    AnimalType -->|Keeping/Pest| AnimalKeepPest["<b>üêï ANIMALS - Keeping &amp; Pest</b><br/><br/><u>Keeping of Animals:</u><br/>Numbers allowed in town/rural: see<br/>Keeping of Animals Factsheet<br/>Application to keep additional animals<br/><br/><u>Pest Animals:</u><br/>Search SDRC website for Factsheets<br/>State Gov: Invasive Animals Fact Sheets<br/><br/>üìå Eli: Keeping Animals v2"]

    %% --- ENVIRONMENTAL ---
    CommDecision -->|Environmental| EnvType{"Stage?"}
    EnvType -->|Initial| EnvStart["<b>üåø ENV NUISANCE - Start</b><br/><br/>1. Determine if council has jurisdiction<br/>Eli: Environmental Nuisance &amp; Pollution<br/>+ SDRC Website<br/>2. If NO jurisdiction:<br/>Direct to appropriate contact<br/>3. If council HAS jurisdiction:<br/>Encourage customer to reach out to<br/>polluter directly and attempt to<br/>resolve without council assistance<br/><br/>üìå Eli: Jurisdiction Check"]
    EnvType -->|Lodge| EnvLodge["<b>üåø ENV NUISANCE - Lodge</b><br/><br/>1. Merit Environment - Choose<br/>appropriate option and lodge request<br/>2. If nuisance is ongoing:<br/>Provide Environmental Nuisance Diary<br/>for evidence and to guide investigation<br/>3. Instruct customer to email completed<br/>diary (14 days) to mail@sdrc.qld.gov.au<br/>Quote Merit number in email<br/><br/>üìå Eli: Nuisance Diary"]

    %% --- WASTE ---
    CommDecision -->|Waste| WasteType{"Request Type?"}
    WasteType -->|Missed/Broken| WasteMissed["<b>üóëÔ∏è WASTE - Missed/Broken</b><br/><br/>Residential Missed Service/Broken Bins<br/>1. Confirm: address, name, phone number<br/>2. Instruct: leave damaged bin on curb<br/>Cleanaway may complete before next<br/>scheduled collection<br/>3. Customer can continue using bin<br/>4. Lodge Cleanaway Bin Request<br/><br/>üìå Cleanaway Service Request"]
    WasteType -->|Missing| WasteMissing["<b>üóëÔ∏è WASTE - Missing Bin</b><br/><br/>1. Confirm: address, name, phone number<br/>2. Lodge Cleanaway Bin Request<br/><br/>üìå Cleanaway Service Request"]
    WasteType -->|Public Place| WastePublic["<b>üóëÔ∏è WASTE - Public Place Bin</b><br/><br/>1. Confirm bin location with customer<br/>2. Check if bin is Council or Cleanaway:<br/>Intramaps - Environment &amp; Regulatory<br/>Check Cleanaway Public Place Bins Icon<br/>3. If Cleanaway: Lodge Cleanaway request<br/>4. If Council: Merit Maintenance<br/>Select Parks, Garden, Reserves<br/><br/>üìå Intramaps Guide"]
    WasteType -->|Infirm| WasteInfirm["<b>üóëÔ∏è WASTE - Infirm Service</b><br/><br/>1. Customer to provide:<br/>Letter requesting infirm service<br/>Note from registered health care practitioner<br/>2. Send to mail@sdrc.qld.gov.au<br/>Records will task to waste team directly<br/><br/>üìå Infirm Process"]
    WasteType -->|Complaint| WasteComplaint["<b>üóëÔ∏è WASTE - Cleanaway Complaint</b><br/><br/>Lodge Merit Complaint<br/>Select: Bins/Collection<br/><br/>üìå Eli: Complaint Process"]

    %% --- COMPLAINTS ---
    CommDecision -->|Complaints| ComplaintRoute["<b>üìù COMPLAINTS</b><br/><br/>For complaints about a council service:<br/><br/>Option 1: Merit Complaint<br/>Select appropriate option<br/><br/>Option 2: Email to mail@sdrc.qld.gov.au<br/>Subject: ATTN: Name<br/>Records will allocate to relevant person<br/><br/>Option 3: Email Form - Complaint Form<br/><br/>üìå Eli: Complaint Process"]

    %% --- CEMETERY (moved to Community) ---
    CommDecision -->|Cemetery| CemeteryType{"Type?"}
    CemeteryType -->|Reserve/Plaque| CemeteryRes["<b>‚ö±Ô∏è CEMETERY - Reserve/Plaque</b><br/><br/>New Reserve:<br/>Email Form: Reserve Application<br/><br/>üìå Eli: Cemetery Reserve"]
    CemeteryType -->|Memorial| CemeteryMemorial["<b>‚ö±Ô∏è CEMETERY - Roadside Memorial</b><br/><br/>Email Form:<br/>Roadside Memorial Application (SDRC Website)<br/><br/>üìå Eli: Roadside Memorials"]
    CemeteryType -->|Location/Interment| CemeteryLoc["<b>‚ö±Ô∏è CEMETERY - Location/Interment</b><br/><br/>1. Transfer to Cemetery staff<br/>2. If unavailable: schedule callback<br/>3. Cemetery Database - Location of<br/>Buried Person:<br/>S:\Shared All\Cemetery\Cemetery Database<br/><br/>üìå Eli: Cemetery Database"]

    %% --- DISPUTES (moved to Community) ---
    CommDecision -->|Disputes| DisputeType{"Jurisdiction?"}
    DisputeType -->|Council| DisputeCouncil["<b>üè† NEIGHBOURLY DISPUTES - Council</b><br/><br/>Dust/Smoke/Noise/Light/Odour/<br/>Water Pollution:<br/>See ENV NUISANCE<br/><br/>Keeping of Animals/Barking/<br/>Dangerous Dogs: See ANIMALS<br/><br/>Illegal Use of Caravan/Tents/Buses,<br/>Illegal Use of Building,<br/>Unauthorised Building Works:<br/>Merit Building<br/><br/>Unlawful Land Use:<br/>Merit Planning<br/><br/>üìå Eli: Disputes Guide"]
    DisputeType -->|Private| DisputePrivate["<b>üè† NEIGHBOURLY DISPUTES - Private</b><br/><br/>Generally refer to QCAT<br/>QLD Gov: Housing &amp; Neighbours<br/><br/>Parking complaints outside<br/>Warwick CBD: Refer to Police<br/>Eli: Regulated Parking<br/><br/>üìå QCAT Referral"]

    %% =============================================
    %% INFRASTRUCTURE
    %% =============================================

    %% --- ROADS ---
    InfraDecision -->|Roads| RoadType{"Issue Type?"}
    RoadType -->|Pothole| RoadPot["<b>üõ£Ô∏è ROADS - Pothole</b><br/><br/>1. Merit Pothole<br/>2. Confirm: sealed or unsealed road<br/>3. Record exact location<br/><br/>üìå Eli: Pothole Reporting"]
    RoadType -->|Road Kill| RoadKill["<b>üõ£Ô∏è ROADS - Road Kill</b><br/><br/>Get details from customer:<br/><br/>If &gt;100kg: Merit Dead<br/>If &lt;100kg: Lodge Cleanaway request<br/><br/>üìå Cleanaway/TMR"]
    RoadType -->|Closure| RoadClose["<b>üõ£Ô∏è ROADS - Closure</b><br/><br/>1. Check Disaster Dashboard<br/>2. Provide link to customer<br/>for real-time updates<br/><br/>üìå Disaster Dashboard Link"]
    RoadType -->|Rail/HWY| RoadRef["<b>üõ£Ô∏è ROADS - Rail/Highway</b><br/><br/>Train Tracks / Railway Crossings:<br/>QLD Rail: 13 16 17<br/><br/>Highway:<br/>TMR: 13 20 80<br/><br/>üìå Referral Contacts"]

    %% --- WORKS ---
    InfraDecision -->|Works| WorksType{"Type?"}
    WorksType -->|Minor| WorksMinor["<b>üî® WORKS - Minor Works</b><br/><br/>Minor Works Within a Road Reserve<br/><br/>See Eli: Roads &amp; Works Forms<br/>for application requirements<br/><br/>üìå Eli: Minor Works Process"]
    WorksType -->|Private| WorksPriv["<b>üî® WORKS - Private Works</b><br/><br/>Member of public engages council<br/>to conduct works on private property<br/><br/>Roads &amp; Works Forms - SDRC<br/><br/>üìå Eli: Private Works Forms"]
    WorksType -->|Operational| WorksOp["<b>üî® WORKS - Operational Works</b><br/><br/>Operational Works inquiry<br/><br/>Merit Works + provide details<br/><br/>üìå Eli: Operational Works"]

    %% --- CAMPGROUNDS ---
    InfraDecision -->|Campgrounds| CampType{"Facility?"}
    CampType -->|Washpool| CampWash["<b>üèïÔ∏è WASHPOOL</b><br/><br/>Enquiries: Eli Washpool<br/>Additional info: Caretaker<br/>Vicki Lynam 0427 026 216<br/>Price: Fees &amp; Charges CTRL+F 523<br/><br/>Bookings:<br/>Refer to Vicki Lynam 0427 026 216<br/>Instruct to leave voicemail if no answer<br/><br/>üìå Eli: Washpool Guide"]
    CampType -->|Connolly Dam| CampConn["<b>üèïÔ∏è CONNOLLY DAM</b><br/><br/>Enquiries: Eli Connolly Dam Camping<br/>Price: Fees &amp; Charges CTRL+F 523<br/><br/>Bookings:<br/>Self-Registration on site<br/>Payment: Cash, cheque, or credit card<br/>Yellow permit on windscreen<br/><br/>üìå Eli: Connolly Dam"]
    CampType -->|River Road| CampRiver["<b>üèïÔ∏è CONDAMINE RIVER ROAD</b><br/><br/>1. Check Disaster Dashboard<br/>2. If rain forecasted: link customer<br/>to dashboard for most current info<br/><br/>üìå Disaster Dashboard"]

    %% =============================================
    %% OTHER SERVICES
    %% =============================================

    %% --- LICENCES ---
    OtherDecision -->|Licence| LicenseType{"Action?"}
    LicenseType -->|Pay| LicensePay["<b>üìÑ LICENCE - Pay/Renew</b><br/><br/>Gather info, process via BPOINT ECM<br/>Customer email needed for receipt<br/><br/>üìå Eli: Licence Renewal"]
    LicenseType -->|Apply| LicenseApply["<b>üìÑ LICENCE - Apply</b><br/><br/>1. Find Form via:<br/>Eli FORMS - Quick Links<br/>OR SDRC Website: Permits &amp; Licences<br/>2. Email Form to customer<br/><br/>üìå Eli: Licence Forms"]

    %% --- CLAIMS ---
    OtherDecision -->|Claims| ClaimsRoute["<b>‚ö†Ô∏è DAMAGE OR INJURY CLAIMS</b><br/><br/>Instruct customer to include:<br/>Name, Time, Location of incident,<br/>Nature of injury/damage,<br/>Evidence: photos, witnesses, etc.<br/><br/>Send Letter of Demand:<br/>Personal/Property Damage:<br/>Subject - ATTN: CEO<br/><br/>Road Related Damage:<br/>Subject - ATTN: Governance<br/><br/>üìå Eli: Claims Process"]

    %% =============================================
    %% CONVERGENCE: CONFIRM DETAILS
    %% =============================================

    RatesPayment --> CustomerDetails
    RatesAdmin --> CustomerDetails
    BuildingInspec --> CustomerDetails
    BuildingExist --> CustomerDetails
    BuildingNew --> CustomerDetails
    PlumbNew --> CustomerDetails
    PlumbExist --> CustomerDetails
    PlumbConnect --> CustomerDetails
    PlumbLeak --> CustomerDetails
    PlumbInspec --> CustomerDetails
    PlanNew --> CustomerDetails
    PlanExist --> CustomerDetails
    PlanPayment --> CustomerDetails
    AnimalLost --> CustomerDetails
    AnimalReg --> CustomerDetails
    AnimalImpound --> CustomerDetails
    BarkNew --> CustomerDetails
    BarkOngo --> CustomerDetails
    AnimalSurrender --> CustomerDetails
    AnimalAttack --> CustomerDetails
    AnimalStray --> CustomerDetails
    AnimalWildlife --> CustomerDetails
    AnimalKeepPest --> CustomerDetails
    EnvStart --> CustomerDetails
    EnvLodge --> CustomerDetails
    WasteMissed --> CustomerDetails
    WasteMissing --> CustomerDetails
    WastePublic --> CustomerDetails
    WasteInfirm --> CustomerDetails
    WasteComplaint --> CustomerDetails
    ComplaintRoute --> CustomerDetails
    CemeteryRes --> CustomerDetails
    CemeteryMemorial --> CustomerDetails
    CemeteryLoc --> CustomerDetails
    DisputeCouncil --> CustomerDetails
    DisputePrivate --> CustomerDetails
    RoadPot --> CustomerDetails
    RoadKill --> CustomerDetails
    RoadClose --> CustomerDetails
    RoadRef --> CustomerDetails
    WorksMinor --> CustomerDetails
    WorksPriv --> CustomerDetails
    WorksOp --> CustomerDetails
    CampWash --> CustomerDetails
    CampConn --> CustomerDetails
    CampRiver --> CustomerDetails
    LicensePay --> CustomerDetails
    LicenseApply --> CustomerDetails
    ClaimsRoute --> CustomerDetails

    CustomerDetails["<b>CONFIRM DETAILS</b><br/>Name, Mobile, Email, Address"]

    %% =============================================
    %% ACTION DECISION
    %% =============================================

    CustomerDetails --> ActionDecision{"<b>ACTION?</b>"}
    
    ActionDecision -->|Lodge Merit| MeritBox["<b>üìã LODGE MERIT</b><br/><br/>1. Input appropriate keyword<br/>and follow process<br/>2. Description must include:<br/>Who, What, When, Where, Why<br/>3. Provide customer with<br/>Merit Req ID for follow-up<br/><br/>üìå Eli: Merit Process"]
    
    ActionDecision -->|Email Form| FormBox["<b>üìß EMAIL FORM</b><br/><br/>1. Find form: Eli FORMS<br/>2. Confirm customer email address<br/>3. Attach form to email<br/>4. Instruct customer: if emailing back,<br/>send to mail@sdrc.qld.gov.au<br/>for records to process application<br/><br/>üìå Eli: FORMS"]
    
    ActionDecision -->|Process Payment| BPOINTBox["<b>üí≥ PROCESS PAYMENT - BPOINT</b><br/><br/>Ref 1: Customer Name<br/>Ref 2: Customer Address<br/>Ref 3: Reference Number<br/>(Application/Licence/Property ID)<br/>Merchant ID: Property ID<br/><br/>Email receipt to customer<br/>(confirm email address)<br/><br/>üìå Eli: BPOINT Guide"]
    
    ActionDecision -->|Transfer / Callback| TransferBox["<b>üì≤ TRANSFER / RETURN CALL</b><br/><br/>1. Establish context: Ask who &amp; why<br/><br/>2a. SDRC Staff/Department:<br/>By Name: Search The Pulse Staff List<br/>By Role: Eli Who to call - What they do<br/>Call to check availability<br/>If available: establish context, transfer<br/>If unavailable: arrange callback via<br/>Merit or email to staff/department<br/><br/>2b. Other Organisation:<br/>Provide contact details<br/>Eli Other Contacts<br/><br/>üìå Eli: Internal Directory"]
    
    ActionDecision -->|Info Provided| NoAction["<b>‚úÖ INFO PROVIDED</b><br/><br/>Customer has answer<br/>or referral contact"]
    
    MeritBox --> Close
    FormBox --> Close
    BPOINTBox --> Close
    TransferBox --> Close
    NoAction --> Close
    
    Close(["‚úÖ <b>CLOSE CALL</b><br/><br/><i>Is there anything else<br/>I can help you with today?</i>"])
    
    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style Close fill:#d4edda,stroke:#28a745,stroke-width:2px
    style Category fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style ActionDecision fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style BPOINTBox fill:#e8daef,stroke:#8e44ad,stroke-width:2px
    style TransferBox fill:#d4edda,stroke:#28a745,stroke-width:2px
    style CustomerDetails fill:#e2e3f3,stroke:#6c757d,stroke-width:2px
    style MeritBox fill:#f8d7da,stroke:#dc3545,stroke-width:2px
    style FormBox fill:#f8d7da,stroke:#dc3545,stroke-width:2px
    style NoAction fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
                </div>
            </div>
        </div>
        
        <div class="info-section">
            <h3>üìä How This Works (Decision Tree Model)</h3>
            
            <div class="info-box">
                <h3>üéØ Structure Overview</h3>
                <p><b>4 Service Categories:</b> Start by choosing Property, Community, Infrastructure, or Other. This immediately narrows your focus.</p>
                <p><b>Decision Diamonds:</b> Each diamond asks a simple question to narrow options. Instead of reading a "wall of text," you answer and the path becomes clear.</p>
                <p><b>Full Step-by-Step Instructions:</b> Every endpoint contains complete instructions, not abbreviations. Perfect for onboarding and quick reference.</p>
                <p><b>Actionable References:</b> Every node includes specific Eli search terms or contact numbers. No dead ends.</p>
            </div>
            
            <div class="info-box">
                <h3>üóÇÔ∏è Service Categories</h3>
                <p><b>üè† Property Services (Blue):</b> Rates, Planning, Building, Plumbing ‚Äì property ownership &amp; development issues.</p>
                <p><b>üë• Community (Green):</b> Animals, Environmental, Waste, Complaints, Cemetery, Neighbourly Disputes ‚Äì community impact issues.</p>
                <p><b>üõ£Ô∏è Infrastructure (Orange):</b> Roads, Works, Campgrounds ‚Äì public assets &amp; facilities.</p>
                <p><b>üìã Other Services (Purple):</b> Licences, Claims ‚Äì miscellaneous.</p>
            </div>
            
            <div class="info-box">
                <h3>üé¨ Typical Call Flow</h3>
                <p><b>1.</b> Greet &amp; verify customer identity</p>
                <p><b>2.</b> Choose service category (Property, Community, Infrastructure, Other)</p>
                <p><b>3.</b> Answer decision questions to narrow down (e.g., "Barking ‚Äì new or ongoing?")</p>
                <p><b>4.</b> Follow the specific step-by-step instructions with exact Eli term</p>
                <p><b>5.</b> Confirm customer details (name, phone, email, address)</p>
                <p><b>6.</b> Take action: Lodge Merit? Email Form? Process Payment? Transfer? Or info already provided?</p>
                <p><b>7.</b> Close call ‚Äì "Anything else I can help with?"</p>
            </div>
            
            <div class="info-box">
                <h3>üí≥ BPOINT Payment Reference</h3>
                <p>Multiple service types are receipted through BPOINT (Rates, Building, Planning, Plumbing, Cemetery, Dog Registration, Keeping of Animals, Works, Licences).</p>
                <p><b>Standard BPOINT Fields:</b> Ref 1: Customer Name | Ref 2: Address | Ref 3: Reference Number (Application/Licence/Property ID) | Merchant ID: Property ID</p>
                <p><b>Always confirm customer email address</b> for sending receipts.</p>
            </div>
            
            <div class="info-box">
                <h3>üìå Using Eli References</h3>
                <p>Every decision node includes a specific "Eli: 'Topic Name'" reference. This is your exact search term in the internal knowledge base.</p>
                <p><b>Example:</b> For a barking dog, the diagram says "Eli: 'Barking Procedure'" ‚Äì search Eli with that exact phrase to find the detailed guide.</p>
                <p><b>No ambiguity.</b> If it says "Eli: 'XYZ'", that's the document. Not a general search.</p>
            </div>
            
            <div class="info-box">
                <h3>üîë Key Systems Reference</h3>
                <p><b>Merit</b> ‚Äî Customer Request Management System (lodge issues for team action)</p>
                <p><b>Eli</b> ‚Äî Internal Knowledge Base (search for exact procedures, forms, guides)</p>
                <p><b>TechOne</b> ‚Äî Financial &amp; Property System (rates, properties, payments)</p>
                <p><b>Intramaps</b> ‚Äî Geographic Information System (GIS ‚Äì maps, facilities, bins)</p>
                <p><b>BPOINT</b> ‚Äî Payment Processing (take payments over phone)</p>
                <p><b>Aqualas</b> ‚Äî Water Leak Location System (determine council vs customer side)</p>
                <p><b>Disaster Dashboard</b> ‚Äî Road closures &amp; event status (real-time updates)</p>
                <p><b>The Pulse</b> ‚Äî Staff Directory (find SDRC employees)</p>
                <p><b>Cleanaway</b> ‚Äî Waste bin contractor (request bins, roadkill, maintenance)</p>
                <p><b>Payreq</b> ‚Äî Rates Notice System (search by Property ID for PDF copies)</p>
            </div>
        </div>
        
        <div class="footer">
            <p>SDRC Customer Service Call Flow Chart ‚Äì Decision Tree Model | For internal use only</p>
            <p><i>Tip: Use "Print 6√ó A4 Poster" to print on regular paper and tape together, or "Save as Image" for a high-res PNG!</i></p>
        </div>
    </div>

    <script>
        let currentZoom = 100;
        const minZoom = 25;
        const maxZoom = 200;
        const zoomStep = 15;
        
        function updateZoom() {
            const mermaid = document.getElementById('mermaidDiagram');
            mermaid.style.transform = `scale(${currentZoom / 100})`;
            document.getElementById('zoomLevel').textContent = currentZoom;
        }
        
        function zoomIn() {
            if (currentZoom < maxZoom) {
                currentZoom += zoomStep;
                updateZoom();
            }
        }
        
        function zoomOut() {
            if (currentZoom > minZoom) {
                currentZoom -= zoomStep;
                updateZoom();
            }
        }
        
        function resetZoom() {
            currentZoom = 100;
            updateZoom();
            document.getElementById('diagramContainer').scrollTo(0, 0);
        }
        
        function fitToScreen() {
            currentZoom = 60;
            updateZoom();
            document.getElementById('diagramContainer').scrollTo(0, 0);
        }
        
        // =============================================
        // POSTER IMAGE EXPORT
        // =============================================
        function showPosterOptions() {
            document.getElementById('posterOptions').classList.add('show');
            document.getElementById('posterStatus').textContent = '';
        }
        
        function hidePosterOptions() {
            document.getElementById('posterOptions').classList.remove('show');
            document.getElementById('posterStatus').textContent = '';
        }
        
        async function savePosterImage() {
            const statusEl = document.getElementById('posterStatus');
            const scale = parseFloat(document.getElementById('posterSize').value);
            
            statusEl.textContent = '‚è≥ Preparing diagram...';
            
            await new Promise(resolve => setTimeout(resolve, 100));
            
            try {
                const mermaidContainer = document.getElementById('mermaidDiagram');
                
                if (!mermaidContainer) {
                    statusEl.textContent = '‚ùå Error: Diagram not found.';
                    return;
                }
                
                if (typeof domtoimage === 'undefined') {
                    statusEl.textContent = '‚ùå Error: Export library not loaded. Please refresh.';
                    return;
                }
                
                statusEl.textContent = '‚è≥ Rendering image...';
                
                const originalTransform = mermaidContainer.style.transform;
                mermaidContainer.style.transform = 'none';
                
                const dataUrl = await domtoimage.toPng(mermaidContainer, {
                    quality: 1,
                    bgcolor: '#ffffff',
                    scale: scale
                });
                
                mermaidContainer.style.transform = originalTransform;
                
                const link = document.createElement('a');
                link.download = `SDRC_CallFlow_Poster_${scale}x.png`;
                link.href = dataUrl;
                link.click();
                
                statusEl.textContent = '‚úÖ Download started!';
                
            } catch (error) {
                console.error('Export error:', error);
                statusEl.textContent = '‚ùå Error: ' + error.message;
            }
        }
        
        // =============================================
        // 6x A4 POSTER PRINT FUNCTION (3 cols √ó 2 rows)
        // =============================================
        async function printAs6xA4() {
            const statusEl = document.getElementById('quadStatus');
            const statusText = document.getElementById('quadStatusText');
            
            statusEl.classList.add('show');
            statusText.textContent = '‚è≥ Capturing diagram...';
            
            await new Promise(resolve => setTimeout(resolve, 100));
            
            try {
                const mermaidContainer = document.getElementById('mermaidDiagram');
                
                if (!mermaidContainer) {
                    statusText.textContent = '‚ùå Error: Diagram not found.';
                    return;
                }
                
                if (typeof domtoimage === 'undefined') {
                    statusText.textContent = '‚ùå Error: Export library not loaded. Please refresh.';
                    return;
                }
                
                const originalTransform = mermaidContainer.style.transform;
                mermaidContainer.style.transform = 'none';
                
                statusText.textContent = '‚è≥ Rendering high-resolution image...';
                
                const dataUrl = await domtoimage.toPng(mermaidContainer, {
                    quality: 1,
                    bgcolor: '#ffffff',
                    scale: 3
                });
                
                mermaidContainer.style.transform = originalTransform;
                
                statusText.textContent = '‚è≥ Splitting into 6 sections (3√ó2)...';
                
                const img = new Image();
                img.onload = function() {
                    const fullWidth = img.width;
                    const fullHeight = img.height;
                    const thirdWidth = fullWidth / 3;
                    const halfHeight = fullHeight / 2;
                    
                    const sections = [];
                    const positions = [
                        { name: 'Top-Left (1/6)', x: 0, y: 0 },
                        { name: 'Top-Middle (2/6)', x: thirdWidth, y: 0 },
                        { name: 'Top-Right (3/6)', x: thirdWidth * 2, y: 0 },
                        { name: 'Bottom-Left (4/6)', x: 0, y: halfHeight },
                        { name: 'Bottom-Middle (5/6)', x: thirdWidth, y: halfHeight },
                        { name: 'Bottom-Right (6/6)', x: thirdWidth * 2, y: halfHeight }
                    ];
                    
                    positions.forEach((pos, index) => {
                        const canvas = document.createElement('canvas');
                        canvas.width = thirdWidth;
                        canvas.height = halfHeight;
                        const ctx = canvas.getContext('2d');
                        
                        ctx.fillStyle = '#ffffff';
                        ctx.fillRect(0, 0, thirdWidth, halfHeight);
                        
                        ctx.drawImage(img, pos.x, pos.y, thirdWidth, halfHeight, 0, 0, thirdWidth, halfHeight);
                        
                        sections.push({
                            name: pos.name,
                            dataUrl: canvas.toDataURL('image/png', 1.0)
                        });
                    });
                    
                    statusText.textContent = '‚è≥ Opening print preview...';
                    
                    const printWindow = window.open('', '_blank');
                    printWindow.document.write(`
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <title>SDRC Call Flow - 6x A4 Poster Print</title>
                            <style>
                                @page {
                                    size: A4 landscape;
                                    margin: 0;
                                }
                                * {
                                    margin: 0;
                                    padding: 0;
                                    box-sizing: border-box;
                                }
                                body {
                                    font-family: Arial, sans-serif;
                                }
                                .page {
                                    width: 297mm;
                                    height: 210mm;
                                    page-break-after: always;
                                    position: relative;
                                    overflow: hidden;
                                }
                                .page:last-child {
                                    page-break-after: auto;
                                }
                                .page img {
                                    width: 100%;
                                    height: 100%;
                                    object-fit: contain;
                                }
                                .page-label {
                                    position: absolute;
                                    bottom: 5mm;
                                    right: 5mm;
                                    background: rgba(255,255,255,0.9);
                                    padding: 2mm 4mm;
                                    font-size: 10px;
                                    color: #666;
                                    border: 1px solid #ccc;
                                    border-radius: 3px;
                                }
                                .alignment-mark {
                                    position: absolute;
                                    background: #ccc;
                                }
                                .alignment-mark.top {
                                    top: 0;
                                    left: 50%;
                                    width: 1px;
                                    height: 10mm;
                                }
                                .alignment-mark.bottom {
                                    bottom: 0;
                                    left: 50%;
                                    width: 1px;
                                    height: 10mm;
                                }
                                .alignment-mark.left {
                                    left: 0;
                                    top: 50%;
                                    width: 10mm;
                                    height: 1px;
                                }
                                .alignment-mark.right {
                                    right: 0;
                                    top: 50%;
                                    width: 10mm;
                                    height: 1px;
                                }
                                .instructions-page {
                                    padding: 20px;
                                    max-width: 700px;
                                    margin: 0 auto;
                                }
                                .instructions-page h1 {
                                    color: #1a365d;
                                    margin-bottom: 15px;
                                }
                                .instructions-page p {
                                    margin-bottom: 10px;
                                    line-height: 1.6;
                                }
                                .instructions-page .grid {
                                    display: grid;
                                    grid-template-columns: 1fr 1fr 1fr;
                                    gap: 10px;
                                    margin: 20px 0;
                                    border: 2px solid #333;
                                    padding: 10px;
                                }
                                .instructions-page .grid div {
                                    padding: 15px;
                                    text-align: center;
                                    border: 1px dashed #999;
                                    font-size: 14px;
                                }
                                .print-action-btn {
                                    display: block;
                                    width: 100%;
                                    padding: 15px;
                                    font-size: 18px;
                                    background: #38a169;
                                    color: white;
                                    border: none;
                                    border-radius: 8px;
                                    cursor: pointer;
                                    margin-top: 20px;
                                }
                                .print-action-btn:hover {
                                    background: #2f855a;
                                }
                                @media print {
                                    .instructions-page {
                                        display: none !important;
                                    }
                                    .page-label {
                                        display: none !important;
                                    }
                                }
                            </style>
                        </head>
                        <body>
                            <div class="instructions-page">
                                <h1>üñ®Ô∏è 6√ó A4 Poster Print (3√ó2)</h1>
                                <p><b>Instructions:</b> Print all 6 pages, then arrange and tape them together like this:</p>
                                <div class="grid">
                                    <div>1. Top-Left</div>
                                    <div>2. Top-Middle</div>
                                    <div>3. Top-Right</div>
                                    <div>4. Bottom-Left</div>
                                    <div>5. Bottom-Middle</div>
                                    <div>6. Bottom-Right</div>
                                </div>
                                <p><b>Print settings:</b></p>
                                <ul style="margin-left: 20px; margin-bottom: 15px;">
                                    <li>Paper size: <b>A4</b></li>
                                    <li>Orientation: <b>Landscape</b></li>
                                    <li>Margins: <b>None</b> or <b>Minimum</b></li>
                                    <li>Scale: <b>100%</b> or <b>Fit to page</b></li>
                                </ul>
                                <button class="print-action-btn" onclick="window.print()">üñ®Ô∏è Print All 6 Pages</button>
                            </div>
                            
                            ${sections.map((s, i) => `
                                <div class="page">
                                    <img src="${s.dataUrl}" alt="${s.name}">
                                    <div class="page-label">${s.name}</div>
                                    <div class="alignment-mark top"></div>
                                    <div class="alignment-mark bottom"></div>
                                    <div class="alignment-mark left"></div>
                                    <div class="alignment-mark right"></div>
                                </div>
                            `).join('')}
                        </body>
                        </html>
                    `);
                    printWindow.document.close();
                    
                    statusEl.classList.remove('show');
                };
                
                img.onerror = function() {
                    statusText.textContent = '‚ùå Error loading image.';
                };
                
                img.src = dataUrl;
                
            } catch (error) {
                console.error('6-page print error:', error);
                statusText.textContent = '‚ùå Error: ' + error.message;
            }
        }
        
        // =============================================
        // MOUSE & KEYBOARD CONTROLS
        // =============================================
        document.getElementById('diagramContainer').addEventListener('wheel', function(e) {
            if (e.ctrlKey || e.metaKey) {
                e.preventDefault();
                if (e.deltaY < 0) {
                    zoomIn();
                } else {
                    zoomOut();
                }
            }
        });
        
        const container = document.getElementById('diagramContainer');
        let isDown = false;
        let startX;
        let startY;
        let scrollLeft;
        let scrollTop;
        
        container.addEventListener('mousedown', (e) => {
            isDown = true;
            startX = e.pageX - container.offsetLeft;
            startY = e.pageY - container.offsetTop;
            scrollLeft = container.scrollLeft;
            scrollTop = container.scrollTop;
        });
        
        container.addEventListener('mouseleave', () => {
            isDown = false;
        });
        
        container.addEventListener('mouseup', () => {
            isDown = false;
        });
        
        container.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - container.offsetLeft;
            const y = e.pageY - container.offsetTop;
            container.scrollLeft = scrollLeft - (x - startX);
            container.scrollTop = scrollTop - (y - startY);
        });
    </script>
</body>
</html>
